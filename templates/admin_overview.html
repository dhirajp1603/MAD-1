{% extends "layout.html" %}

{% block title %}Platform Overview - Admin Dashboard{% endblock %}

{% block content %}
<h2>Platform Overview</h2>
<div class="overview-stats">
    <p><strong>Total Users:</strong> {{ num_users }}</p>
    <p><strong>Total Services:</strong> {{ num_services }}</p>
    <p><strong>Total Bookings:</strong> {{ total_bookings }}</p>
    <p><strong>Total Revenue:</strong> Rs.{{ total_revenue }}</p>
    <p><strong>Blocked Users:</strong> {{ blocked_users }}</p>
    <p><strong>Approved Professionals:</strong> {{ approved_professionals }}</p>
</div>

<div class="charts-container">
    <div id="chart-container" style="width: 48%; display: inline-block; vertical-align: top;">
        <h3>Platform Activity</h3>
        <canvas id="user-chart"></canvas>
    </div>
    <div id="chart-container" style="width: 48%; display: inline-block; vertical-align: top;">
        <h3>Bookings & Services</h3>
        <canvas id="booking-chart"></canvas>
    </div>
</div>

<!-- New Section for Additional Data (Number of Requested/Completed Services) -->
<div class="service-status-charts" style="margin-top: 40px; display: flex; justify-content: space-between;">
    <div>
        <h3>Requested Services</h3>
        <canvas id="requested-services-chart"></canvas>
    </div>
    <div>
        <h3>Completed Services</h3>
        <canvas id="completed-services-chart"></canvas>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // JavaScript for rendering charts with Chart.js
    const userChart = new Chart(document.getElementById('user-chart'), {
        type: 'pie',
        data: {
            labels: ['Active Users', 'Blocked Users'],
            datasets: [{
                data: [{{ num_users - blocked_users }}, {{ blocked_users }}],
                backgroundColor: ['#36a2eb', '#ff6384'],
            }]
        }
    });

    const bookingChart = new Chart(document.getElementById('booking-chart'), {
        type: 'bar',
        data: {
            labels: ['Bookings', 'Revenue'],
            datasets: [{
                label: 'Platform Activity',
                data: [{{ total_bookings }}, {{ total_revenue }}],
                backgroundColor: ['#4caf50', '#ffcd56']
            }]
        }
    });

    const requestedServicesChart = new Chart(document.getElementById('requested-services-chart'), {
        type: 'bar',
        data: {
            labels: ['Requested Services'],
            datasets: [{
                label: 'Number of Requested Services',
                data: [{{ num_requested_services }}],
                backgroundColor: '#ff9f40'
            }]
        }
    });

    const completedServicesChart = new Chart(document.getElementById('completed-services-chart'), {
        type: 'bar',
        data: {
            labels: ['Completed Services'],
            datasets: [{
                label: 'Number of Completed Services',
                data: [{{ num_completed_services }}],
                backgroundColor: '#4caf50'
            }]
        }
    });
</script>

{% endblock %}
