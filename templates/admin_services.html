{% extends "layout.html" %}

{% block title %}Manage Services - Admin Dashboard{% endblock %}

{% block content %}
<h2 style="color: #333; margin-bottom: 20px;">Manage Services</h2>

<!-- Create New Service Form -->
<div style="margin: 20px 0;">
    <h3>Create a New Service</h3>
    <form action="{{ url_for('create_service') }}" method="POST" style="display: grid; gap: 10px;">
        <input type="text" name="name" placeholder="Service Name" required style="padding: 8px; width: 100%; box-sizing: border-box;">
        <input type="number" step="0.01" name="price" placeholder="Price" required style="padding: 8px; width: 100%; box-sizing: border-box;">
        <input type="text" name="time_required" placeholder="Time Required (in hours)" required style="padding: 8px; width: 100%; box-sizing: border-box;">
        <textarea name="description" placeholder="Description" style="padding: 8px; width: 100%; box-sizing: border-box;"></textarea>
        <button type="submit" style="padding: 8px 12px; background-color: #007bff; color: #fff; cursor: pointer; border: none;">Create Service</button>
    </form>
</div>

<hr style="margin: 20px 0;">

<!-- List of Services with Update/Delete Options -->
<div style="margin: 20px 0;">
    <h3>Existing Services</h3>
    <table style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="background-color: #f4f4f4;">
                <th style="border: 1px solid #ddd; padding: 10px; text-align: center;">Service ID</th>
                <th style="border: 1px solid #ddd; padding: 10px; text-align: center;">Name</th>
                <th style="border: 1px solid #ddd; padding: 10px; text-align: center;">Price</th>
                <th style="border: 1px solid #ddd; padding: 10px; text-align: center;">Time Required</th>
                <th style="border: 1px solid #ddd; padding: 10px; text-align: center;">Description</th>
                <th style="border: 1px solid #ddd; padding: 10px; text-align: center;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for service in services %}
            <tr style="border: 1px solid #ddd;">
                <td style="padding: 10px; text-align: center;">{{ service.service_id }}</td>
                <td style="padding: 10px; text-align: center;">{{ service.name }}</td>
                <td style="padding: 10px; text-align: center;">${{ service.price }}</td>
                <td style="padding: 10px; text-align: center;">{{ service.time_required }}</td>
                <td style="padding: 10px; text-align: center;">{{ service.description }}</td>
                <td style="padding: 10px; text-align: center;">
                    <!-- Toggle Update Form Button -->
                    <button onclick="toggleUpdateForm('{{ service.service_id }}')" style="padding: 8px 12px; background-color: #28a745; color: #fff; cursor: pointer; border: none;">Edit</button>
                    
                    <!-- Update Service Form (Hidden by default) -->
                    <form id="update-form-{{ service.service_id }}" action="{{ url_for('update_service', service_id=service.service_id) }}" method="POST" style="display: none; margin-top: 10px;">
                        <input type="text" name="name" value="{{ service.name }}" required style="padding: 8px; width: 100%; box-sizing: border-box;">
                        <input type="number" step="0.01" name="price" value="{{ service.price }}" required style="padding: 8px; width: 100%; box-sizing: border-box;">
                        <input type="text" name="time_required" value="{{ service.time_required }}" required style="padding: 8px; width: 100%; box-sizing: border-box;">
                        <textarea name="description" style="padding: 8px; width: 100%; box-sizing: border-box;">{{ service.description }}</textarea>
                        <button type="submit" style="padding: 8px 12px; background-color: #28a745; color: #fff; cursor: pointer; border: none;">Update</button>
                    </form>

                    <!-- Delete Service Form -->
                    <form action="{{ url_for('delete_service', service_id=service.service_id) }}" method="POST" style="display: inline-block;">
                        <button type="submit" style="padding: 8px 12px; background-color: #dc3545; color: #fff; cursor: pointer; border: none;">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    function toggleUpdateForm(serviceId) {
        const form = document.getElementById('update-form-' + serviceId);
        form.style.display = form.style.display === 'none' ? 'block' : 'none';
    }
</script>
{% endblock %}
